<div class="game-container">
  <!-- Header with Diwali decorations -->
  <div class="header">
    <div class="diya-decoration left">ðŸª”</div>
    <h1 class="game-title">Who Wants To Be<br>Diwali Millionaire</h1>
    <div class="diya-decoration right">ðŸª”</div>
  </div>

  <!-- Start Screen -->
  @if (!gameStarted()) {
    <div class="start-screen">
      <div class="welcome-message">
        <h2>âœ¨ Welcome to the Festival of Lights! âœ¨</h2>
        <p>Test your knowledge and win virtual prizes!</p>
        <button class="start-button" (click)="startGame()">
          <span class="sparkle">âœ¨</span> Start Game <span class="sparkle">âœ¨</span>
        </button>
      </div>
      <div class="decorations">
        <div class="rangoli">ðŸŒ¸ ðŸŒº ðŸŒ¼ ðŸŒ» ðŸŒ¸</div>
      </div>
    </div>
  }

  <!-- Game Screen -->
  @if (gameStarted() && !gameOver()) {
    <div class="game-screen">
      <div class="main-area">
        <!-- Lifeline Panel -->
        <div class="lifeline-panel">
          <button 
            class="lifeline-button"
            [class.used]="lifelinesUsed().fiftyFifty"
            [disabled]="lifelinesUsed().fiftyFifty || selectedAnswer() !== null"
            (click)="useFiftyFifty()"
            title="50:50 - Remove two incorrect answers">
            <span class="lifeline-icon">50:50</span>
            <span class="lifeline-label">50:50</span>
          </button>
          
          <button 
            class="lifeline-button"
            [class.used]="lifelinesUsed().askAudience"
            [disabled]="lifelinesUsed().askAudience || selectedAnswer() !== null"
            (click)="useAskAudience()"
            title="Ask the Audience">
            <span class="lifeline-icon">ðŸ‘¥</span>
            <span class="lifeline-label">Audience</span>
          </button>
          
          <button 
            class="lifeline-button"
            [class.used]="lifelinesUsed().phoneFriend"
            [disabled]="lifelinesUsed().phoneFriend || selectedAnswer() !== null"
            (click)="usePhoneFriend()"
            title="Phone a Friend">
            <span class="lifeline-icon">ðŸ“ž</span>
            <span class="lifeline-label">Phone</span>
          </button>
        </div>

        <!-- Walk Away Button -->
        <div class="walk-away-container">
          <button 
            class="walk-away-button"
            [disabled]="selectedAnswer() !== null || currentQuestionIndex() === 0"
            (click)="walkAway()"
            title="Walk away with your current prize">
            ðŸ’° Walk Away ({{ getCurrentPrize() }})
          </button>
        </div>

        <!-- Question Display -->
        <div class="question-container">
          <div class="question-number">
            Question {{ currentQuestionIndex() + 1 }} of {{ questions().length }}
          </div>
          <div class="question-text">
            {{ getCurrentQuestion()?.question }}
          </div>
        </div>

        <!-- Phone a Friend Hint -->
        @if (phoneFriendHint()) {
          <div class="phone-hint">
            <div class="phone-hint-title">ðŸ“ž Your Friend Says:</div>
            <div class="phone-hint-text">
              "{{ phoneFriendHint()!.confidence }} 
              <strong>{{ ['A', 'B', 'C', 'D'][phoneFriendHint()!.suggestedAnswer] }}</strong>."
            </div>
          </div>
        }

        <!-- Answer Options -->
        <div class="answers-grid">
          @for (option of getRenderedOptions(); track option; let i = $index) {
            <button 
              class="answer-button"
              [class.selected]="selectedAnswer() === i"
              [class.correct]="selectedAnswer() === i && answeredCorrectly()"
              [class.wrong]="selectedAnswer() === i && !answeredCorrectly() && selectedAnswer() !== null"
              [class.removed]="isOptionRemoved(i)"
              [class.highlighted]="phoneFriendHint()?.suggestedAnswer === i"
              [disabled]="selectedAnswer() !== null || isOptionRemoved(i)"
              (click)="selectAnswer(i)">
              <span class="option-letter">{{ ['A', 'B', 'C', 'D'][i] }}:</span>
              <span class="option-text">{{ option }}</span>
              @if (audienceVotes()) {
                <span class="audience-vote">{{ getAudienceVotePercentage(i) }}%</span>
              }
            </button>
          }
        </div>

        <!-- Audience Chart -->
        @if (audienceVotes()) {
          <div class="audience-chart">
            <div class="audience-chart-title">ðŸ‘¥ Audience Says:</div>
            <div class="audience-bars">
              @for (vote of audienceVotes(); track vote.optionIndex) {
                <div class="audience-bar-container">
                  <div class="audience-bar-label">{{ ['A', 'B', 'C', 'D'][vote.optionIndex] }}</div>
                  <div class="audience-bar-wrapper">
                    <div class="audience-bar" [style.width.%]="vote.percentage"></div>
                  </div>
                  <div class="audience-bar-percentage">{{ vote.percentage }}%</div>
                </div>
              }
            </div>
          </div>
        }
      </div>

      <!-- Money Ladder -->
      <div class="sidebar">
        <div class="money-ladder">
          <h3>Prize Ladder</h3>
          <div class="money-ladder-levels" #moneyLadderLevels>
            @for (level of moneyLadder(); track level.amount; let i = $index) {
              <div 
                class="money-level"
                [class.current]="level.current"
                [class.reached]="level.reached"
                [class.checkpoint]="level.isCheckpoint"
                [attr.data-level-index]="i">
                <span class="prize-amount">{{ level.amount }}</span>
                @if (level.isCheckpoint) {
                  <span class="checkpoint-indicator">âœ“</span>
                }
              </div>
            }
          </div>
        </div>
      </div>
    </div>
  }

  <!-- Game Over Screen -->
  @if (gameOver() && sessionResult()) {
    <app-game-summary 
      [result]="sessionResult()!"
      (playAgain)="resetGame()">
    </app-game-summary>
  }

  <!-- Footer decoration -->
  <div class="footer-decoration">
    <span>ï¿½ï¿½</span>
    <span>âœ¨</span>
    <span>ðŸŽ†</span>
    <span>âœ¨</span>
    <span>ðŸª”</span>
  </div>

  <!-- Version number -->
  <div class="version-number">v{{ version }}</div>
</div>
